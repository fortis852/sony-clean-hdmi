  build-sony-apk:
    runs-on: ubuntu-latest
    needs: build-apk
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up JDK 8
      uses: actions/setup-java@v4
      with:
        java-version: '8'
        distribution: 'temurin'
    
    - name: Setup Android SDK minimal
      run: |
        # Download only necessary tools
        mkdir -p android-sdk
        cd android-sdk
        
        # Get platform-tools for aapt, dx
        wget -q https://dl.google.com/android/repository/platform-tools-latest-linux.zip
        unzip -q platform-tools-latest-linux.zip
        
        # Get build-tools
        wget -q https://dl.google.com/android/repository/build-tools_r25.0.3-linux.zip
        unzip -q build-tools_r25.0.3-linux.zip
        
        cd ..
        export PATH=$PATH:$PWD/android-sdk/platform-tools:$PWD/android-sdk/build-tools/25.0.3
    
    - name: Build Sony APK
      run: |
        chmod +x scripts/build_sony_apk.sh
        ./scripts/build_sony_apk.sh
    
    - name: Upload Sony APK
      uses: actions/upload-artifact@v4
      with:
        name: CleanHDMI-Sony-${{ github.run_number }}
        path: build/sony/*.apk
        retention-days: 30
